"use strict";(self.webpackChunkcheckout_web=self.webpackChunkcheckout_web||[]).push([["app_components_AddressForm_AddressForm_tsx-app_components_Step_Step_tsx-app_utilities_receipt-bc12cf"],{HNWf:(e,r,n)=>{n.d(r,{Um:()=>dr,kS:()=>sr,kZ:()=>ur,bE:()=>ir,g:()=>lr});var t=n("Nlia"),a=n("tESi"),o=n("zThL"),s=n("+9dH"),d=n("Vadf"),i=n("79Ja"),l=n("5hh5"),u=n("PIe1"),c=(n("ma9I"),n("2eJa"),n("1AHG"),n("2B1R"),n("07d7"),n("JfAA"),n("zKZe"),n("x0AG"),n("+2oP"),n("XbcX"),n("c9m3"),n("tkto"),n("yq1k"),n("JTJg"),n("FNk8"),n("fbCW"),n("4l63"),n("TeQF"),n("B6y2"),n("Cmfx")),f=n("TSYQ"),p=n.n(f),m=n("0xfQ"),v=n("CrLc"),g=n("Y5sR"),y=n("KGbM"),h=n("9EMo"),C=n("wZ06"),b=n("8/fR"),_=n("kOLJ"),E=n("wtZy"),w=n("3rkp"),k=n("W74s"),A=n("ltVc"),S=n("sj0v"),Z=n("4E7I"),I=n("dZRL"),T=n("ElIa"),z=n("mZ5W"),x=n("CKJw");function N(e){return/[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\uff10-\uff19]/.test(e)}n("rB9j"),n("ALS0");var P=n("g4Fy"),q=n("kaQ/"),L=n("0Rb5"),D=n("Q0qb"),O=n("x6+w"),M=n("LwUr"),F=n("LTE9"),B=n("b35x"),V=n("rZtW"),R=n("37Uq"),U=n("cVfI"),G=n("/0+J"),j=(n("FZtP"),n("T63A"),n("pjDv"),n("PKPk"),n("4mDm"),n("3bBZ"),n("Jjkx")),J=n("K4mA"),Y=n("WZSz"),K=n("idgT"),Q=n("Zmn1");function W(e){var r=e.fieldValidationResult,n=e.matchingStrategy,t=e.address,a=e.addressType,o=e.trackAddressValidation;r.forEach((function(e,r){"validation-api"===e.source&&o(e.id,t,e.concern,n,e.suggestion,a,r)}))}var H=n("GLNU"),X=n("5rqR"),$=n("DAhp");const ee={Suggestion:"vv0g120"},re={WarningIconWrapper:"TkcBT"};function ne(e){var r,n,t,a,o,s,d,i=e.address,l=e.addressErrors,u=e.addressSuggestions,f=e.suggestion,p=e.field,g=e.addressType,y=e.validationId,h=(0,b.Dv)(i),C=lr(p,i),_=(0,m.q)(),E=(0,V.Zu)(u,l).resetAddressFieldSuggestions,w=(0,V.kO)(l).resetAddressFieldErrors,k=(t=(0,F.a)(),a=(0,M._v)(),o=(0,O.Lk)(),s=(0,L.L)().id,d=(0,v.b)(),(0,c.useCallback)((function(e,r,n,i,l){if(t){var u,c,f=(null==a||null==(u=a.value)||null==(c=u.defaultAttributes)?void 0:c.uniqToken)||"",p={schemaId:B.gn.AddressValidationSuggestionAcceptance,payload:{shopId:parseInt((0,D.Bp)(s),10),checkoutToken:o.checkoutSessionIdentifier||"",uniqueToken:f,locale:d,country:e,validationId:r,suggestionId:n,acceptedField:i,context:"shipping"===l?"Shipping address":"Billing address"}};t.record(p)}}),[d,t,o.checkoutSessionIdentifier,s,null==a||null==(r=a.value)||null==(n=r.defaultAttributes)?void 0:n.uniqToken])),A=function(){null!=f&&f.address&&(k(h.countryCode||"",y,f.id,p,g),C(Object.assign(Object.assign({},h),null==f?void 0:f.address)),E(p),w(p))},S=function(e){var r;return r="zoneCode"===e?""+(null==f?void 0:f.address.zone):""+(null==f?void 0:f.address[e]),c.default.createElement("button",{className:ee.Suggestion,onClick:A},r)}(p),Z=(null==f?void 0:f.message)+". ",I=null==f?void 0:f.type;return c.default.createElement(c.default.Fragment,null,"warning"===I?c.default.createElement(H.T,{columns:["auto","fill"],spacing:"small300"},c.default.createElement("div",{className:re.WarningIconWrapper},c.default.createElement(X.JO,{source:"info"})),c.default.createElement($.x,null,_("field_errors.address_suggestion_did_you_mean_html",{html:S},{options:{noWrapElementReplacements:!0}},"Did you mean %{html}?"))):c.default.createElement(c.default.Fragment,null,Z,_("field_errors.address_suggestion_did_you_mean_html",{html:S},{options:{noWrapElementReplacements:!0}},"Did you mean %{html}?")))}function te(e,r,n,t,a,o,s,d,i){W({address:r,fieldValidationResult:e,trackAddressValidation:o,addressType:i,matchingStrategy:d}),e.forEach((function(e,o){if("validation-api"===e.source){if(s)if(e.suggestion){var d=e.id,l=e.suggestion,u=e.type,f=c.default.createElement(ne,{validationId:d,address:r,addressErrors:n,addressSuggestions:t,suggestion:l,field:o,addressType:i});a.write(n[o],{value:f,type:u,textValue:"Invalid address"}),a.write(t[o],l)}else e.error&&("warning"===e.type?(a.write(n[o],{value:c.default.createElement(H.T,{columns:["auto","fill"],spacing:"small300"},c.default.createElement(X.JO,{source:"info"}),c.default.createElement($.x,null,e.error)),type:"warning",textValue:"Invalid address"}),a.write(t[o],{type:"warning",message:e.error})):a.write(n[o],e.error))}else a.write(n[o],{message:e.error,origin:"client",type:"on-submit"})}))}var ae=n("2mXy"),oe=(n("Tskq"),n("6cQw"),n("St1C"));var se=["US"];function de(e){var r=e.addressValidationAPIEnabled,n=e.errors,t=e.addressType,a=e.countryCode;return r&&0===n.size&&se.includes(a||"")&&"shipping"===t}n("E9XD"),n("YGK4");var ie=function(e){function r(){for(var r,n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return(r=e.call.apply(e,[this].concat(t))||this).name="AddressValidationError",r}return(0,l.Z)(r,e),(0,i.Z)(r)}((0,u.Z)(Error));function le(e){switch(e){case"address1":return"address1";case"address2":return"address2";case"country_code":case"countryCode":case"country":return"countryCode";case"zip":return"postalCode";case"province":case"province_code":case"provinceCode":return"zoneCode";case"city":return"city";case"phone":return"phone";default:throw new ie("Unknown Address Component")}}function ue(e){var r=new Map([["countryCode",0],["coordinates",2],["zoneCode",4],["postalCode",8],["address1",16],["address2",32],["city",64]]),n=function(e,n){var t;return e|(null!=(t=r.get(le(n)))?t:0)},t=e.reduce((function(e,r){var t;if(null==r.fieldNames)return[];var a=r.fieldNames.reduce(n,0);return e[a]=function(e,r){if(!e&&r)return r;if(e&&!r)return e;if(e.type!==r.type)return"error"===e.type?e:r;switch(e.type){case"error":return e.typeLevel<r.typeLevel?e:r;case"warning":return e.typeLevel>r.typeLevel?e:r}}(null!=(t=e[a])?t:void 0,r),e}),{});return(0,R.Z)(new Set(Object.values(t)))}function ce(e){var r,n,t,a,o,s,d;return void 0===e?{}:{address1:null!=(r=e.address1)?r:void 0,address2:null!=(n=e.address2)?n:void 0,city:null!=(t=e.city)?t:void 0,zoneCode:null!=(a=e.provinceCode)?a:void 0,zone:null!=(o=e.province)?o:void 0,postalCode:null!=(s=e.zip)?s:void 0,countryCode:null!=(d=e.countryCode)?d:void 0}}var fe=n("DToX");function pe(e,r){switch(e){case"address_zip_invalid_for_country":return"shipping"===r?fe.j.DeliveryInvalidPostalCodeForCountry:fe.j.PaymentsInvalidPostalCodeForCountry;case"address_zip_blank":return"shipping"===r?fe.j.DeliveryPostalCodeRequired:fe.j.PaymentsPostalCodeRequired;case"address_zip_invalid_for_country_and_province":return"shipping"===r?fe.j.DeliveryInvalidPostalCodeForZone:fe.j.PaymentsInvalidPostalCodeForZone;case"address_zip_contains_emojis":return"shipping"===r?fe.j.DeliveryPostalCodeContainsEmojis:fe.j.PaymentsPostalCodeContainsEmojis}return"shipping"===r?"DELIVERY_POSTAL_CODE_BLANK":"PAYMENTS_POSTAL_CODE_BLANK"}var me=n("XVbA"),ve=n("Mbjm"),ge=n("Gcjb"),ye=function(e){function r(r){var n;(n=e.call(this,"AddressValidationServiceError")||this).name="AddressValidationServiceError",n.errors=void 0;var t=["Not allowed"];return n.errors=r.map((function(e){return e.message})).filter((function(e){return!t.includes(e)})),n}return(0,l.Z)(r,e),(0,i.Z)(r)}((0,u.Z)(Error)),he=n("hgQp");var Ce=n("mqoD"),be=n("A9oH"),_e=n("2aYu");function Ee(e){var r,n,t,a=e.address,o=e.addressOptions,s=e.inPaymentContext,i=void 0!==s&&s,l=e.disabled,u=void 0!==l&&l,f=(0,b.Dv)(a),p=(0,m.q)(),v=(n=a,t=(0,b.xP)(),function(e){var r=n.fields,a=r.firstName,o=r.lastName,s=r.company,d=r.address1,i=r.address2,l=r.city,u=r.countryCode,c=r.postalCode,f=r.zoneCode,p=r.phone,m=r.coordinates;t.write(a,e.firstName),t.write(o,e.lastName),t.write(s,e.company),t.write(d,e.address1),t.write(i,e.address2),t.write(l,e.city),t.write(u,e.countryCode),t.write(c,e.postalCode),t.write(f,e.zoneCode),t.write(p,e.phone),t.write(m,e.coordinates)}),g=null==(r=o.find((function(e){return(0,w.LD)(f,e.address)})))?void 0:r.value,y=(0,c.useRef)(!1),h=(0,c.useMemo)((function(){return[].concat((0,R.Z)(o),[{label:p("contact.new_address_label","Use a new address"),value:""+o.length,address:(0,_e.f0)({countryCode:a.fields.countryCode.init,zoneCode:a.fields.zoneCode.init})}])}),[o,p,a.fields.countryCode.init,a.fields.zoneCode.init]),C=h[h.length-1].value,_=(0,c.useState)(g&&!i?g:C),E=(0,d.Z)(_,2),k=E[0],A=E[1];if(i&&!y.current){var S=h[parseInt(k,10)].address;v(S)}return(0,c.useEffect)((function(){var e,r=null==(e=o.find((function(e){return(0,w.LD)(f,e.address)})))?void 0:e.value;A(r||C)}),[f,o,C]),(0,c.useEffect)((function(){y.current=!0}),[]),c.default.createElement(be.P,{value:k,label:p("contact.stored_addresses_label","Saved addresses"),options:h,onChange:function(e){var r=h[parseInt(e,10)].address;v(r),A(e)},disabled:u})}var we=n("E2mC"),ke={tabindex:"-1",label:"",ariaHidden:!0,ariaLabel:"no-label",type:"text"},Ae=(0,c.memo)((function(e){var r=e.address,n=e.addressType,t=e.availableCountries,a=e.country,o=e.onAutofillCaptured,d=(0,E.er)(),i=(0,b.xP)(),l=function(e){return function(n){var t=n.currentTarget.value;i.write(r.fields[e],t),null==o||o()}},u=function(){return function(e){var n=e.currentTarget.value;i.write(r.fields.zoneCode,n)}};return c.default.createElement(we.G,{visibility:"hidden"},c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_firstName",name:"firstName",autoComplete:f(n,"given-name"),onChange:l("firstName")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_lastName",name:"lastName",autoComplete:f(n,"family-name"),onChange:l("lastName")})),d.isVisible("company")&&c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_company",name:"company",autoComplete:f(n,"organization"),onChange:l("company")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_address1",name:"address1",autoComplete:f(n,d.isVisible("address2")?"address-line1":"street-address"),onChange:l("address1")})),d.isVisible("address2")&&c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_address2",name:"address2",autoComplete:f(n,"address-line2"),onChange:l("address2")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_city",name:"city",autoComplete:f(n,"address-level2"),onChange:l("city")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_country",name:"country",autoComplete:f(n,"country"),onChange:function(e){var n=e.currentTarget.value,a=t.find((function(e){return e.value===n||e.label.toLowerCase()===n.toLowerCase()}));a&&i.write(r.fields.countryCode,a.value)}})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_zone",name:"zone",autoComplete:f(n,"address-level1"),onChange:u()})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_address_level1",name:"address-level1",autoComplete:f(n,"address-level1"),onChange:u()})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_province",name:"province",autoComplete:f(n,"address-level1"),onChange:u()})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_postalCode",name:"postalCode",autoComplete:f(n,"postal-code"),onChange:l("postalCode")})),d.isVisible("phone",a.code)&&c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_phone",name:"phone",autoComplete:f(n,"tel"),onChange:l("phone")})));function f(e,r){return e?e+" "+r:r}})),Se=(0,c.memo)((function(e){var r=e.address,n=e.addressType,t=e.availableCountries,a=e.country,o=e.onAutofillCaptured,d=(0,E.er)(),i=(0,b.xP)(),l=function(e){return function(n){var t=n.currentTarget.value;i.write(r.fields[e],t),null==o||o()}};return c.default.createElement(we.G,{visibility:"hidden"},d.isVisible("address2")&&c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_collapsed_address2",name:"address2",autoComplete:u(n,"address-line2"),onChange:l("address2")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_collapsed_city",name:"city",autoComplete:u(n,"address-level2"),onChange:l("city")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_collapsed_zone",name:"zone",autoComplete:u(n,"address-level1"),onChange:function(e){var n=e.currentTarget.value;i.write(r.fields.zoneCode,n)}})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_collapsed_address_level1",name:"address-level1",autoComplete:u(n,"address-level1"),onChange:function(e){var n=e.currentTarget.value;i.write(r.fields.zoneCode,n)}})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_postal_collapsed_postalCode",name:"postalCode",autoComplete:u(n,"postal-code"),onChange:l("postalCode")})),d.isVisible("phone",a.code)&&c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill__collapsed_phone",name:"phone",autoComplete:u(n,"tel"),onChange:l("phone")})),c.default.createElement("input",(0,s.Z)({},ke,{id:"autofill_collapsed_country",name:"country",autoComplete:u(n,"country"),onChange:function(e){var n=e.currentTarget.value,a=t.find((function(e){return e.value===n||e.label.toLowerCase()===n.toLowerCase()}));a&&i.write(r.fields.countryCode,a.value)}})));function u(e,r){return e?e+" "+r:r}})),Ze=n("hnXR"),Ie=n("MSOA"),Te=n("46pf");function ze(e){var r=e.address,n=e.addressErrors,t=e.addressType,a=e.addressSettings,o=e.loading,d=e.editDisabled,i=(0,m.q)(),l=(0,Ie.D)().firstNameRequired,u=a.isRequired("firstName")||l(t),f=(0,c.useCallback)((function(e){if(u&&!(0,Te.Um)(e))return i("field_errors.address_first_name_blank","Enter a first name")}),[u,i]),p=(0,Te.a8)(r.fields.firstName,n.firstName,f);return c.default.createElement(Ze.nv,(0,s.Z)({name:"firstName",label:u?i("contact.first_name_label","First name"):i("contact.optional_first_name_label","First name (optional)"),required:u,autocomplete:{group:t,field:"given-name"},readonly:o||d},p))}var xe=n("npLZ");function Ne(e){var r=e.address,n=e.addressType,t=e.addressErrors,a=e.addressSettings,o=e.loading,d=e.editDisabled,i=(0,m.q)(),l=(0,xe.I)(),u=a.isRequired("lastName"),f=(0,c.useCallback)((function(e){if(u&&!(0,Te.Um)(e))return i("field_errors.address_last_name_blank","Enter a last name")}),[u,i]),p=(0,Te.a8)(r.fields.lastName,t.lastName,f),v=u?i("contact.last_name_label","Last name"):i("contact.optional_last_name_label","Last name (optional)");return c.default.createElement(Ze.nv,(0,s.Z)({name:"lastName",label:l?i("contact.optional_recipient_label","Attention (optional)"):v,required:u,autocomplete:{group:n,field:"family-name"},readonly:o||d},p))}var Pe=n("fzNA");function qe(e){var r,n=e.addressType,t=e.address,a=e.addressErrors,o=e.addressSettings,d=e.loading,i=e.editDisabled,l=(0,m.q)(),u=(0,xe.I)(),f="inactive"!==(0,Pe.E)(),p=o.isRequired("company"),v=(0,c.useCallback)((function(e){if(p&&!(0,Te.Um)(e))return l("field_errors.address_company_blank","Enter a company name")}),[p,l]),g=(0,Te.a8)(t.fields.company,a.company,v),y=f&&void 0===g.value?{value:null==u||null==(r=u.shippingAddress)?void 0:r.company}:{};return c.default.createElement(Ze.nv,(0,s.Z)({name:"company",label:p?l("contact.company_label","Company"):l("contact.optional_company_label","Company (optional)"),required:p,autocomplete:{group:n,field:"organization"},readonly:d||i},g,y))}var Le=n("9hbr"),De=n("1c6z"),Oe=n("S+oI");function Me(){var e=(0,m.q)();return c.default.createElement(Oe.g,{blockAlignment:"center",spacing:"small200"},c.default.createElement(X.JO,{source:"info"}),c.default.createElement($.x,null,e("contact.civic_number_warning","Add a house number if you have one")))}const Fe={"Field-sizeSmall":"Vob8N","Input-AccessoryOffset":"R5Ptu"};function Be(e){var r=e.country,n=e.address,t=e.addressRef,a=e.addressType,i=e.addressErrors,l=e.addressSettings,u=e.loading,f=e.editDisabled,g=e.missingBuildingNumberInAddress2,h=e.autocompleteDisabled,C=e.resetAddressSuggestions,_=(0,m.q)(),E=(0,b.KO)(n.fields.coordinates),w=(0,d.Z)(E,2)[1],k=(0,b.Dv)(n.fields.address1),A=(0,b.Dv)(n.fields.address2),S=(0,c.useState)(!N(k||"")),Z=(0,d.Z)(S,2),I=Z[0],T=Z[1],z=(0,b.xP)(),x=(0,F.a)(),P=(0,O.Lk)(),q=(0,L.L)().id,V=(0,M._v)(),R=(0,v.b)(),U=(0,Y.I)(),G=z.read(n).value,j=(0,c.useCallback)((function(e){if(!(0,Te.Um)(e))return _("field_errors.address_address1_blank","Enter an address")}),[_]),J=(0,Te.a8)(n.fields.address1,i.address1,j),K=function(e){e!==J.value&&(w(void 0),J.onChange(e),null==C||C(),N(e)||T(!0))},Q=function(e){N(e)&&T(!1),J.onInput(e)},W=l.isVisible("address2")?"address-line1":"street-address",H=!h&&(0,Le.rx)(r,l),X={group:a,field:W},$=!1;r.buildingNumberRequired&&($=Boolean(I&&k),r.buildingNumberMayBeInAddress2&&($=Boolean(I&&g&&(k||A))));var ee=(0,c.useRef)($);ee.current!==$&&($&&function(){if(V.value.defaultAttributes&&x){var e,n=(null==(e=V.value.defaultAttributes)?void 0:e.uniqToken)||"",t={schemaId:B.gn.BuildingNumberNudge,payload:{checkoutToken:P.checkoutSessionIdentifier||"",shopId:parseInt((0,D.Bp)(q),10),uniqueToken:n,address1:G.address1||"",address2:G.address2||"",city:G.city||"",zone:G.zoneCode||"",zip:G.postalCode||"",territory:r.code,promptType:"missing_street_number",locale:R,context:"shipping"===a?"Shipping address":"Billing address"}};null==x||x.record(t)}}(),ee.current=$);var re=H?c.default.createElement(Ve,(0,s.Z)({},e,J,{onChange:K,onInput:Q,autocomplete:X})):c.default.createElement(Ze.nv,(0,s.Z)({ref:t,name:"address1",label:_("contact.address1_label","Address"),required:!0,autocomplete:X,readonly:u||f},J,{onChange:K,onInput:Q})),ne=p()(Fe["Field-sizeSmall"],(0,o.Z)({},Fe["Input-AccessoryOffset"],H));return c.default.createElement("div",{className:ne},c.default.createElement(y.E,{spacing:"small200"},re,$&&"BASIC"===U&&c.default.createElement(Me,null)))}function Ve(e){var r=e.value,n=e.error,t=e.onInput,a=e.onChange,o=e.onAddressAutoComplete,s=e.loading,d=e.editDisabled,i=e.address,l=e.autocomplete,u=e.addressType,f=e.onBlur,p=e.resetAddressSuggestions,v=(0,m.q)(),g=ir(i,o,p),y=(0,b.Dv)(i.fields.countryCode);return c.default.createElement(De.w,{name:"address1",field:"address1",label:v("contact.address1_label","Address"),accessory:c.default.createElement(X.JO,{source:"magnify",appearance:"subdued"}),countryCode:y,onSelect:g,required:!0,autocomplete:l,readonly:s||d,value:r,error:n,onChange:a,onInput:t,addressType:u,onBlur:f})}var Re=function(e){return e.Focused="focused",e.Visible="visible",e.Hidden="hidden",e}(Re||{});function Ue(e){var r,n=e.address,t=e.addressType,a=e.addressErrors,o=e.addressSettings,i=e.loading,l=e.editDisabled,u=e.setMissingBuildingNumberInAddress2,f=e.resetAddressSuggestions,p=(0,m.q)(),v=(0,oe.un)(),g=(0,c.useRef)(null),y=o.isRequired("address2"),C=(0,c.useCallback)((function(e){if(y&&!(0,Te.Um)(e))return p("field_errors.address_address2_blank","Enter an apartment, suite, etc.")}),[y,p]),b=(0,Te.a8)(n.fields.address2,a.address2,C),_=Boolean(null==(r=b.value)?void 0:r.length),E=!v||y||_?Re.Visible:Re.Hidden,w=(0,c.useState)(E),k=(0,d.Z)(w,2),A=k[0],S=k[1];return(0,c.useEffect)((function(){var e;A===Re.Focused&&(null==(e=g.current)||e.focus())}),[A]),(0,c.useEffect)((function(){A===Re.Hidden&&_&&S(Re.Visible)}),[A,_]),A===Re.Hidden?c.default.createElement(we.G,null,c.default.createElement(h.r,{textDecoration:"none",onPress:function(){S(Re.Focused)}},c.default.createElement(Oe.g,{spacing:"small400",blockAlignment:"center"},c.default.createElement(X.JO,{source:"plus",size:"extraSmall"}),p("shipping.address2_add_label","Add apartment, suite, etc.")))):c.default.createElement(Ze.nv,(0,s.Z)({name:"address2",label:y?p("contact.address2_label","Apartment, suite, etc."):p("contact.optional_address2_label","Apartment, suite, etc. (optional)"),required:y,autocomplete:{group:t,field:"address-line2"},readonly:i||l},b,{ref:g,onChange:function(e){b.onChange(e),null==f||f(),N(e)||null==u||u(!0)},onInput:function(e){b.onInput(e),N(e)&&(null==u||u(!1))}}))}var Ge=n("ntLC");const je={"Field-sizeSmall":"ii1aN"};var Je=new Map([[z.C.Ca,/^[A-Za-z]\d[A-Za-z]\s*\d[A-Za-z]\d$/],[z.C.Us,/^\d{5}(?:[-\s]?\d{4})?$/]]);function Ye(e){var r=e.country,n=e.address,t=e.addressType,a=e.addressErrors,o=e.addressSettings,i=e.loading,l=e.editDisabled,u=e.resetAddressSuggestions,f=(0,m.q)(),p=(0,c.useCallback)((function(e){if(!(0,Te.Um)(e))return f("field_errors.address_zip_blank","Enter a ZIP / postal code")}),[f]),v=(0,Te.a8)(n.fields.postalCode,a.postalCode,p),g=(0,c.useState)(v.value),y=(0,d.Z)(g,2),h=y[0],C=y[1];(0,b.bQ)(n.fields.postalCode,(function(e){e!==h&&C(e)}));var _=(0,b.KO)(n.fields.coordinates),E=(0,d.Z)(_,2)[1],w=r.autocompletionField===Ge.N.PostalCode&&o.autocompleteEnabled&&(0,Le.h0)(r.code),k=function(e){e!==v.value&&(E(void 0),v.onChange(e),null==u||u())},A=Je.get(r.code),S=w?c.default.createElement(Qe,(0,s.Z)({},e,v,{onChange:k})):c.default.createElement(Ze.nv,(0,s.Z)({name:"postalCode",label:r.labels.postalCode,required:!0,inputMode:Ke(r),autocomplete:{group:t,field:"postal-code"},letterCase:"uppercase",readonly:i||l},v,{onInput:function(e){var r=e.toLocaleUpperCase();v.onInput(r),C(r),A&&A.test(r)&&k(r)},onChange:k,controlledValue:h}));return c.default.createElement("div",{className:je["Field-sizeSmall"]},S)}function Ke(e){return e.pureNumericPostalCode?"numeric":"text"}function Qe(e){var r=e.value,n=e.error,t=e.onInput,a=e.onChange,o=e.onAddressAutoComplete,s=e.loading,d=e.editDisabled,i=e.address,l=e.addressType,u=e.onBlur,f=e.resetAddressSuggestions,p=(0,m.q)(),v=ir(i,o,f),g=(0,b.Dv)(i.fields.countryCode);return c.default.createElement(De.w,{name:"postalCode",field:"postalCode",label:p("contact.postal_code_label","Postal code"),countryCode:g,onSelect:v,required:!0,autocomplete:{group:l,field:"postal-code"},readonly:s||d,value:r,error:n,onChange:a,onInput:t,addressType:l,onBlur:u})}function We(e){var r=e.address,n=e.addressType,t=e.addressErrors,a=e.loading,o=e.editDisabled,i=e.resetAddressSuggestions,l=(0,m.q)(),u=(0,c.useCallback)((function(e){if(!(0,Te.Um)(e))return l("field_errors.address_city_blank","Enter a city")}),[l]),f=(0,Te.a8)(r.fields.city,t.city,u),p=(0,b.KO)(r.fields.coordinates),v=(0,d.Z)(p,2)[1];return c.default.createElement(Ze.nv,(0,s.Z)({name:"city",label:l("contact.city_label","City"),required:!0,autocomplete:{group:n,field:"address-level2"},readonly:a||o},f,{onChange:function(e){e!==f.value&&(v(void 0),f.onChange(e),null==i||i())}}))}function He(e){var r,n=e.country,t=e.address,a=e.addressType,o=e.addressErrors,i=e.loading,l=e.editDisabled,u=e.resetAddressSuggestions,f=(0,m.q)(),p=(0,c.useCallback)((function(e){if(!(0,Te.Um)(e))return f("field_errors.address_province_blank","Select a state / province")}),[f]),v=(0,Te.a8)(t.fields.zoneCode,o.zoneCode,p),g=(0,b.KO)(t.fields.coordinates),y=(0,d.Z)(g,2)[1],h=(0,b.KO)(o.postalCode),C=(0,d.Z)(h,2)[1];return(0,c.useEffect)((function(){var e,r=null==v||null==(e=v.value)?void 0:e.toLowerCase(),t=n.zones.find((function(e){return e.code===(null==v?void 0:v.value)||e.name.toLowerCase()===r}));t&&v.onChange(t.code)}),[n.zones,v]),c.default.createElement(be.P,(0,s.Z)({name:"zone",label:n.labels.zone,placeholder:n.labels.zone,options:(r=n.zones,r.map((function(e){return{label:e.name,value:e.code}}))),required:!0,autocomplete:{group:a,field:"address-level1"},readonly:i||l},v,{onChange:function(e){e!==v.value&&(y(void 0),C(void 0),null==u||u(),v.onChange(e))}}))}function Xe(e){var r,n=e.address,t=e.addressType,a=e.addressErrors,o=e.availableCountries,i=e.loading,l=e.editDisabled,u=e.resetAddressSuggestions,f=(0,m.q)(),p=(0,Te.a8)(n.fields.countryCode,a.countryCode),g=(0,Te.a8)(n.fields.zoneCode,a.zoneCode),y=(0,oe.un)(),h=(0,b.KO)(n.fields.coordinates),C=(0,d.Z)(h,2)[1],_=(0,b.KO)(a.postalCode),E=(0,d.Z)(_,2)[1],w=(0,b.KO)(a.zoneCode),k=(0,d.Z)(w,2)[1],A=(0,F.a)(),S=(0,O.Lk)(),Z=(0,L.L)().id,I=(0,M._v)(),T=(0,v.b)(),z=(0,c.useCallback)((function(e,r){if(I.value.defaultAttributes&&A){var n,a=(null==(n=I.value.defaultAttributes)?void 0:n.uniqToken)||"",o={schemaId:B.gn.CountrySelection,payload:{checkoutToken:S.checkoutSessionIdentifier||"",shopId:parseInt((0,D.Bp)(Z),10),uniqueToken:a,territoryCode:r,selectionMethod:e,context:"shipping"===t?"Shipping address":"Billing address",locale:T}};null==A||A.record(o)}}),[I.value.defaultAttributes,A,t,T,S.checkoutSessionIdentifier,Z]);return(0,c.useEffect)((function(){z("auto-selected",p.value)}),[null==(r=I.value.defaultAttributes)?void 0:r.uniqToken,A]),c.default.createElement(be.P,(0,s.Z)({name:"countryCode",label:f("contact.country_label","Country/Region"),options:o,required:!0,autocomplete:{group:t,field:"country"},readonly:i||l},p,{onChange:function(e){y||g.onChange(void 0),e!==p.value&&(p.onChange(e),null==u||u(),C(void 0),k(void 0),E(void 0),z("user-input",e))}}))}var $e=n("0Q12"),er=n("nL10"),rr=n("OWXZ");function nr(e){var r=e.country,n=e.addressType,t=e.addressErrors,a=e.addressSettings,o=e.addressFormSettings,d=e.address,i=e.loading,l=e.editDisabled,u=r.code,f=(0,m.q)(),p=a.isRequired("phone",u),v=(0,rr.fD)(),g=(0,c.useCallback)((function(e){var r=(0,Te.Um)(e);return p&&!r?f("contact.errors.blank.contact_info.phone","Enter a phone number"):r&&!v(null!=e?e:"",u)?f("field_errors.shipping_line_phone_invalid","Enter a valid phone number"):void 0}),[p,v,u,f]),y=(0,Te.a8)(d.fields.phone,t.phone,g),h=(0,Z.m)(),C=h?f("siberia.contact.optional_phone_label","Phone Number (optional)"):f("contact.optional_phone_label","Phone (optional)"),b=h?f("siberia.contact.phone_label","Phone Number"):f("contact.phone_label","Phone"),_=!1!==(null==o?void 0:o.phoneTooltip)&&c.default.createElement($e.an,{activator:c.default.createElement(X.JO,{source:"question",appearance:"subdued",accessibilityLabel:f("general.tooltip_accessibility_label","More information")})},f("contact.phone_tooltip","In case we need to contact you about your order"));return c.default.createElement(er.$,(0,s.Z)({name:"phone",countryCode:u,label:p?b:C,hideCountries:!0,required:p,autocomplete:{group:n,field:"telephone"},readonly:i||l,accessory:_||void 0},y))}const tr="I9W0A";var ar=["addressRef","additionalGroups","autocompleteDisabled","group"],or=function(e){function r(){for(var r,n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return(r=e.call.apply(e,[this].concat(t))||this).name="UnexpectedFieldError",r}return(0,l.Z)(r,e),(0,i.Z)(r)}((0,u.Z)(Error)),sr=(0,c.memo)((function(e){var r=e.id,n=e.address,t=e.countries,i=e.addressSettings,l=e.addressType,u=e.addressErrors,f=e.additionalFieldGroups,z=e.children,H=e.expanded,X=void 0===H||H,$=e.autocompleteDisabled,ee=void 0!==$&&$,re=e.collapsible,ne=void 0!==re&&re,se=e.settings,ie=e.loading,fe=void 0!==ie&&ie,be=e.onAddressAutoComplete,_e=e.onManualAddressEntryClick,we=e.onAutofillCaptured,ke=e.inPaymentContext,Ze=e.showSavedAddressSelector,Ie=void 0===Ze||Ze,Te=(0,m.q)(),ze=(0,C.Q)().geolocation,xe=(0,E.er)(),Ne=(0,x.Ew)(),Pe=(0,d.Z)(Ne,1)[0],qe=(0,b.Dv)(n.fields.countryCode),Le=(0,c.useMemo)((function(){return(0,w.Yu)()}),[]),De=(0,V.Zu)(Le,u).resetAddressSuggestions,Oe=(0,b.xP)(),Me=(0,k.eS)(T.k.Delivery,A.sC.Destination)&&"shipping"===l,Fe=(0,Z.m)(),Be=(0,I.J$)(qe),Ve=Be.details,Re=Be.loading,Ue=(0,c.useMemo)((function(){return null!=i?i:xe}),[i,xe]),Ge=(0,c.useMemo)((function(){return null!=Ve?Ve:ze.country}),[Ve,ze.country]),je=(0,c.useMemo)((function(){return!t||Me?[{value:Ge.code,label:Ge.name}]:t}),[t,Ge,Me]),Je=(0,S.Zo)(),Ye=(0,c.useMemo)((function(){if("CustomerProfile"===(null==Je?void 0:Je.__typename)){var e="shipping"===l?null==Je?void 0:Je.shippingAddresses:null==Je?void 0:Je.billingAddresses;return(null!=e?e:[]).map((function(e,r){var n=e.address;return{value:r.toString(),label:n.label,address:Object.assign({},n)}}))}return[]}),[Je,l]),Ke=Ye.length>0,Qe=(0,c.useMemo)((function(){var e=Ge;if(Fe){var r=e.formatting.edit;e.formatting.edit=(0,w.l4)(r)}return(0,w.mt)(e,Ue)}),[Ge,Ue,Fe]),We=(0,c.useMemo)((function(){return Qe.findIndex((function(e){return"{address1}"===e.id}))+1}),[Qe]),He=(0,c.useMemo)((function(){return ur(Qe)}),[Qe]),Xe=He.groupsBeforeCountry,$e=He.countryGroup,er=He.groupsAfterCountry;!function(e,r){var n=r.addressType,t=r.addressErrors,a=r.suggestions,o=r.countryCode,s=r.availableCountries,i=r.addressSettings,l=(0,b.xP)(),u=(0,J.cp)(""),f=(0,Y.I)(),p="ES_STREET"===f,m=function(){var e,r,n=(0,F.a)(),t=(0,M._v)(),a=(0,O.Lk)(),o=(0,L.L)().id,s=(0,v.b)(),d=(0,oe.vQ)(),i=(0,b.xP)(),l=(0,c.useMemo)((function(){return new Map}),[]);return(0,c.useCallback)((function(e,r,u,c,f,p,m){var v=i.read(r).value,g=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.join("")}(JSON.stringify(v),JSON.stringify(f),p,m,u,c,e);if(n&&!l.has(g)){var y,h;l.set(g,{address:r,suggestion:f,addressType:p,addressFieldKey:m,concern:u,matchingStrategy:c});var C=(null==t||null==(y=t.value)||null==(h=y.defaultAttributes)?void 0:h.uniqToken)||"",b={schemaId:B.gn.AddressValidation,payload:{checkoutToken:a.checkoutSessionIdentifier||"",shopId:parseInt((0,D.Bp)(o),10),uniqueToken:C,locale:s,address1:v.address1,address2:v.address2,city:v.city,zip:v.postalCode,zone:v.zoneCode,country:v.countryCode||"",validationId:e,address1Suggested:null==f?void 0:f.address.address1,address2Suggested:null==f?void 0:f.address.address2,citySuggested:null==f?void 0:f.address.city,zipSuggested:null==f?void 0:f.address.postalCode,zoneSuggested:null==f?void 0:f.address.zoneCode,countrySuggested:(null==f?void 0:f.address.countryCode)||"",errorFields:u.fieldNames||[],errorCodes:[u.code],errorType:u.type,matchingStrategy:c,suggestionsCount:u.suggestionIds.length||0,checkoutView:d?"Single page":"Multi page",context:"shipping"===p?"Shipping address":"Billing address"}};n.record(b)}}),[i,n,l,null==t||null==(e=t.value)||null==(r=e.defaultAttributes)?void 0:r.uniqToken,a.checkoutSessionIdentifier,o,s,d])}(),g=(0,V.Zu)(a,t).resetAddressSuggestions,y=(0,V.kO)(t).resetAddressErrors,h="ES_STREET",C=function(e){var r,n,t,a,o,s,d,i=e.countryCode,l=e.countries,u=e.addressSettings,f=(r=(0,v.b)(),n=(0,K.I)(),t=(0,c.useMemo)((function(){return new Map}),[]),a=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.join("")},o=(0,L.L)().id,s=(0,O.Lk)(),d=(0,he.c)().validation,(0,c.useCallback)((0,G.Z)((0,U.Z)().mark((function e(i,l){var u,c,f,p,m,v,g,y,h,C,b,_,E;return(0,U.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=i.address1,c=i.address2,f=i.zoneCode,p=i.countryCode,m=i.postalCode,v=i.city,g=i.phone,y=a(u,c,v,f,m,p,g,l),t.has(l)||t.set(l,new Map),h=t.get(l),e.prev=4,C=h.get(y)||d({address1:u,address2:c,zoneCode:f,countryCode:p,postalCode:m,city:v,phone:g},r,l,{shopId:(0,D.Bp)(o),sourceId:s.sourceId||""}),h.clear(),h.set(y,C),e.next=10,C;case 10:if(b=e.sent,_=b.data,!(E=b.errors)){e.next=15;break}throw new ye(E);case 15:return e.abrupt("return",_.validation);case 18:return e.prev=18,e.t0=e.catch(4),e.t0 instanceof ye&&e.t0.errors.length>0&&n.leaveBreadcrumb("AddressValidation service failed",{errors:e.t0.errors}),e.abrupt("return",{id:"",concerns:[],suggestions:[],locale:r,validationScope:[],fields:[]});case 22:case"end":return e.stop()}}),e,null,[[4,18]])}))),[t,d,r,o,s.sourceId,n])),p=(0,V.TC)(i,l,u),m=(0,me.w)(ve.AU),g=(0,me.w)(ve.N8),y=(0,oe.vQ)(),h=(0,ge.mQ)()||m&&!g&&!y;return(0,c.useCallback)((0,G.Z)((0,U.Z)().mark((function e(r){var n,t,a,o,s,d,i,l,u,c;return(0,U.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.addressType,t=r.address,a=r.matchingStrategy,o=r.experimentGroup,s=r.validationTestGroup,d=r.action,i=new Map,l=p(t,n),"submit"===d&&l.forEach((function(e,r){i.set(r,{error:e,type:"error",source:void 0,matchingStrategy:a})})),!de({addressValidationAPIEnabled:h,errors:l,addressType:n,countryCode:t.countryCode})){e.next=11;break}return e.next=7,f(t,a);case 7:u=e.sent,c=new Map,u.suggestions.forEach((function(e){return c.set(e.id,e)})),ue(u.concerns).forEach((function(e){var r=le(e.fieldNames[0]),t=e.suggestionIds.length>0?{address:ce(c.get(e.suggestionIds[0])),message:e.message,code:e.code,type:e.type.toLowerCase(),id:e.suggestionIds[0]}:void 0;"address_missing_building_number"===e.code&&"BASIC"===o||(i.set(r,{id:u.id,error:e.message,suggestion:t,concernCode:"postalCode"===r?pe(e.code||"",n):e.code,type:e.type.toLowerCase(),concern:e,source:"validation-api",matchingStrategy:a}),s&&l.set(r,e.message))}));case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)}))),[p,h,f])}({countryCode:o,countries:s,addressSettings:i}),_=(0,c.useCallback)((function(r){return C({address:l.read(e).value,addressType:n,matchingStrategy:h,experimentGroup:f,validationTestGroup:p,action:r})}),[e,n,C,f,h,l,p]),E=(0,c.useCallback)((function(r){return C({address:l.read(e).value,addressType:n,matchingStrategy:h,experimentGroup:f,validationTestGroup:!1,action:r})}),[e,n,C,f,h,l]),w=(0,K.I)(),k=(0,x.Ew)(),S=(0,d.Z)(k,1)[0],Z=(0,c.useCallback)((function(r,t){W({address:e,matchingStrategy:t,fieldValidationResult:r,addressType:n,trackAddressValidation:m})}),[e,n,m]),I=(0,Q.y1)((0,G.Z)((0,U.Z)().mark((function r(o){var s,d,i,c;return(0,U.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("progression"!==l.read(u).value){r.next=2;break}return r.abrupt("return");case 2:return s=l.read(e),d=s.revision,r.next=5,_();case 5:return i=r.sent,l.read(e).revision===d&&te(i,e,t,a,l,m,p,h,n),r.prev=7,r.next=10,E();case 10:c=r.sent,l.read(e).revision===d&&Z(c,h),r.next=16;break;case 14:r.prev=14,r.t0=r.catch(7);case 16:case"end":return r.stop()}}),r,null,[[7,14]])}))),150);(0,b.bQ)(e,(function(e){l.write(u,""),I(e)})),(0,j.$u)((0,G.Z)((0,U.Z)().mark((function r(o){var s,i,c,f,v,C;return(0,U.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=o.reason,i=o.parts,l.write(u,s),"negotiation"!==s){r.next=4;break}return r.abrupt("return",{behavior:"allow"});case 4:if(!S){r.next=6;break}return r.abrupt("return",{behavior:"allow"});case 6:return Object.entries(t).forEach((function(e){var r,n=Object.keys(t).includes(e[0])?l.read(t[e[0]]).value:"";if("string"==typeof n&&(r=n),Object.keys(a).includes(e[0])&&(0,ae.l$)(n)){var o=l.read(a[e[0]]).value;r="error"===(null==o?void 0:o.type)?null==o?void 0:o.message:""}if(r)return w.leaveBreadcrumb("Blocking address error",{errorMessage:r}),{behavior:"block",reason:A.VO.InvalidAddress}})),r.next=9,_("submit");case 9:if(c=r.sent,"shipping"!==l.read(i.billingAddressOption).value||"billing"!==n){r.next=15;break}return y(),g(),r.abrupt("return",{behavior:"allow"});case 15:if(f=Array.from(c,(function(e){return(0,d.Z)(e,2)[1].error})).filter((function(e){return e})),E().then((function(e){(0,R.Z)(e.values()).find((function(e){return"error"===(null==e?void 0:e.type)}))&&Z(e,h)})).catch((function(){})),v=Array.from(c,(function(e){return(0,d.Z)(e,2)[1]})).filter((function(e){return"error"===(null==e?void 0:e.type)})).length>0,C=Array.from(c,(function(e){return(0,d.Z)(e,2)[1]})).filter((function(e){return"validation-api"!==(null==e?void 0:e.source)})).length>0,!(p&&v||!p&&C)){r.next=22;break}return w.leaveBreadcrumb("blocking errors",{errors:f}),r.abrupt("return",{behavior:"block",reason:A.VO.InvalidAddress,perform:function(){te(c,e,t,a,l,m,p,h,n)}});case 22:return r.abrupt("return",{behavior:"allow",perform:function(){g(),p||v&&Z(c,h)}});case 23:case"end":return r.stop()}}),r)}))))}(n,{countryCode:qe,availableCountries:je,addressSettings:Ue,suggestions:Le,addressType:l,addressErrors:u}),function(e,r,n,t,o,s,i){var l=(0,b.xP)(),u=(0,b.Dv)(e.fields.countryCode),f=(0,c.useMemo)((function(){return r.flatMap((function(e){return e.fields}))}),[r]);(0,c.useEffect)((function(){for(var e=0,r=Object.keys(n);e<r.length;e++){var a=r[e];f.includes(a)||(l.write(n[a],void 0),Object.keys(t).includes(a)&&l.write(t[a],void 0))}}),[l,n,t,f]);var p=(0,F.a)(),m=(0,O.Lk)(),g=(0,L.L)().id,y=(0,M._v)(),h=(0,I.J$)(u).details,C=(0,v.b)(),E=(0,Y.I)();var k=(0,c.useCallback)((function(e){if("error"===e.type&&null!=i&&!o){for(var r,t=e.violations,c=(0,w.YO)(i,t),f=!1,p=(0,a.Z)(c);!(r=p()).done;){var m=(0,d.Z)(r.value,2),v=m[0],g=m[1];l.write(n[v],g),s.isVisible(v,u)||(f=!0)}f&&window.location.reload()}}),[o,s,i,n,l,u]),A=(0,q.g)();(0,c.useEffect)((function(){k(A)}),[A,k]),(0,_.lH)((function(r){(function(r){if("error"===r.type&&null!=i&&!o)for(var t,s=r.violations,u=(0,w.YO)(i,s),c=(0,a.Z)(u);!(t=c()).done;){var f=(0,d.Z)(t.value,2),v=f[0],b=f[1];l.write(n[v],b)}for(var _=[],k=0,A=Object.keys(n);k<A.length;k++){var S=A[k];l.read(n[S]).value&&_.push(S)}if("invalid"===r.type||"error"===r.type||"success"===r.type&&"progression"===r.negotiationStage){var Z,I=l.read(e).value;if("invalid"===r.type&&(Z=r.reasons.toString()),y.value.defaultAttributes){var T,z,x,N=(null==(T=y.value.defaultAttributes)?void 0:T.uniqToken)||"",P=(null==h||null==(z=h.zones)||null==(x=z.find((function(e){return e.code===I.zoneCode})))?void 0:x.name)||I.zoneCode,q={schemaId:B.gn.AddressSubmission,payload:{checkoutToken:m.checkoutSessionIdentifier||"",shopId:parseInt((0,D.Bp)(g),10),uniqueToken:N,territory:(null==h?void 0:h.name)||"",context:"shipping"===i?"Shipping address":"Billing address",address1:I.address1||"",address2:I.address2||"",city:I.city||"",zone:P||"",zip:I.postalCode||"",errorCode:Z||"",errorFields:_,locale:C,matchingStrategy:E}};null==p||p.record(q)}}})(r),k(r)}))}(n,Qe,u,Le,Pe,Ue,l);var rr=(0,c.useState)(!1),nr=(0,d.Z)(rr,2),ar=nr[0],or=nr[1];(0,c.useEffect)((function(){Ue.isVisible("phone",Ge.code)||Oe.write(n.fields.phone,"")}),[Ge,n.fields.phone,Ue,Oe]),(0,c.useEffect)((function(){if(Re||fe){var e=setTimeout((function(){return or(!0)}),400);return function(){return clearTimeout(e)}}or(Re)}),[fe,Re]);var sr=(0,b.Dv)(n.fields.address2),ir=(0,c.useState)(!N(sr||"")),lr=(0,d.Z)(ir,2),cr=lr[0],fr=lr[1],pr=(0,c.useRef)(null),mr={address:n,addressErrors:u,addressType:l,addressSettings:Ue,addressRef:pr,addressFormSettings:se,country:Ge,availableCountries:je,onAddressAutoComplete:be,missingBuildingNumberInAddress2:cr,setMissingBuildingNumberInAddress2:fr,resetAddressSuggestions:De},vr=(0,c.useCallback)((function(){null==_e||_e(),setTimeout((function(){var e;null==(e=pr.current)||e.focus()}))}),[_e]);return c.default.createElement("div",{id:r},c.default.createElement(P.g,{active:ar},c.default.createElement(Ce.l,null,Je&&Ke&&Ie?c.default.createElement(Ee,{address:n,addressOptions:Ye,inPaymentContext:ke,disabled:Me}):null,ne?c.default.createElement(c.default.Fragment,null,Qe.slice(0,We).map((function(e){return c.default.createElement(dr,(0,s.Z)({key:e.id,group:e,additionalGroups:f},mr,{loading:ar,autocompleteDisabled:ee,editDisabled:Me}))})),!X&&c.default.createElement(Se,{address:n,addressType:l,country:Ge,availableCountries:je,onAutofillCaptured:we}),c.default.createElement("div",{className:"_Yuii"},c.default.createElement("div",{className:tr},c.default.createElement(g.u,{id:"collapsed-fields",open:X,renderChildrenWhenCollapsed:!0},c.default.createElement(Ce.l,null,Qe.slice(We).map((function(e){return c.default.createElement(dr,(0,s.Z)({key:e.id,group:e,additionalGroups:f},mr,{loading:ar,editDisabled:Me}))})),z))),c.default.createElement("div",{className:p()(tr,(0,o.Z)({},"z4F0X",X))},c.default.createElement(y.E,{inlineAlignment:"start"},c.default.createElement(h.r,{"aria-controls":"collapsed-fields",onPress:vr},Te("shipping.enter_address_manually_label","Enter address manually")))))):c.default.createElement(c.default.Fragment,null,Xe.map((function(e){return c.default.createElement(dr,(0,s.Z)({key:e.id,group:e,additionalGroups:f},mr,{loading:ar,editDisabled:Me}))})),c.default.createElement(dr,(0,s.Z)({key:"country",group:$e,additionalGroups:f},mr,{loading:ar,editDisabled:Me})),er.map((function(e){return c.default.createElement(dr,(0,s.Z)({key:e.id,group:e,additionalGroups:f},mr,{loading:ar,editDisabled:Me}))})),z)),c.default.createElement(Ae,{address:n,addressType:l,country:Ge,availableCountries:je,onAutofillCaptured:we})))}));function dr(e){var r,n=e.addressRef,a=e.additionalGroups,o=e.autocompleteDisabled,d=e.group,i=(0,t.Z)(e,ar),l=i.loading,u=null!=(r=null==a?void 0:a.filter((function(e){var r=e.after;return d.fields.includes(r)})))?r:[];return c.default.createElement(c.default.Fragment,null,c.default.createElement(Ce.T,null,d.fields.map((function(e){switch(e){case"firstName":return c.default.createElement(ze,i);case"lastName":return c.default.createElement(Ne,i);case"company":return c.default.createElement(qe,i);case"address1":return c.default.createElement(Be,(0,s.Z)({},i,{addressRef:n,autocompleteDisabled:o}));case"address2":return c.default.createElement(Ue,i);case"postalCode":return c.default.createElement(Ye,i);case"city":return c.default.createElement(We,i);case"zoneCode":return c.default.createElement(He,i);case"countryCode":return c.default.createElement(Xe,i);case"phone":return c.default.createElement(nr,i);default:throw new or("Unexpected field: "+e)}}))),u.map((function(e){return c.default.createElement(Ce.T,{key:e.id},e.render({loading:l}))})))}function ir(e,r,n){var t=(0,b.xP)();return function(a){var o,s=e.fields,d=s.coordinates,i=s.address1,l=s.address2,u=s.city,c=s.zoneCode,f=s.countryCode,p=s.postalCode;t.write(d,a.coordinates),t.write(i,null!=(o=a.address1)?o:""),t.write(l,(function(e){var r;return null!=(r=a.address2)?r:e})),t.write(u,a.city),t.write(c,a.zoneCode),t.write(f,(function(e){var r=Object.values(z.C).find((function(e){var r;return e===(null==(r=a.countryCode)?void 0:r.toUpperCase())}));return null!=r?r:e})),t.write(p,a.postalCode),null==n||n(),null==r||r(a)}}function lr(e,r){var n=(0,b.xP)();return function(t){var a,o=r.fields,s=o.address1,d=o.address2,i=o.city,l=o.zoneCode,u=o.postalCode,c=null!=(a=t[e])?a:"";switch(e){case"address1":n.write(s,c);break;case"address2":n.write(d,c);break;case"city":n.write(i,c);break;case"zoneCode":n.write(l,c);break;case"postalCode":n.write(u,c)}}}function ur(e){var r=e.findIndex((function(e){return e.fields.includes("countryCode")}));return{groupsBeforeCountry:e.slice(0,r),countryGroup:e[r],groupsAfterCountry:e.slice(r+1)}}},"1c6z":(e,r,n)=>{n.d(r,{w:()=>u});var t,a=n("cVfI"),o=n("/0+J"),s=(n("4mDm"),n("07d7"),n("5s+n"),n("PKPk"),n("3bBZ"),n("Cmfx")),d=n("p7Db"),i=n("hnXR"),l=n("iXXV"),u=(0,d.L)({load:(t=(0,o.Z)((0,a.Z)().mark((function e(){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.R)((function(){return n.e("AutocompleteField").then(n.bind(n,"EtGU"))}));case 2:return e.abrupt("return",e.sent.AutocompleteField);case 3:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)}),id:function(){return"EtGU"},renderLoading:function(e){return s.default.createElement(i.nv,e)}})},mqoD:(e,r,n)=>{n.d(r,{T:()=>l,l:()=>i});var t=n("Cmfx"),a=n("Rdrx"),o=n("KGbM"),s=n("/Y3H"),d=n("GLNU");function i(e){var r=e.children,n=(0,a.G)().formLayout.spacing;return t.default.createElement(o.E,{spacing:n},r)}function l(e){var r=e.children,n=(0,a.G)().formLayout.spacing,i=void 0===n?"base":n,l=(0,s.Vt)({base:!0,small:!1})?o.E:d.T;return t.default.createElement(l,{spacing:i},r)}},g4Fy:(e,r,n)=>{n.d(r,{g:()=>s});var t=n("Cmfx"),a=n("7Xy6");const o={Wrapper:"pxSEU",Loading:"Kyqce"};function s(e){var r=e.active,n=void 0!==r&&r,s=e.size,d=void 0===s?"base":s,i=e.children;return t.default.createElement("div",{className:o.Wrapper,"aria-hidden":n?"true":"false"},n&&t.default.createElement("div",{className:o.Loading},t.default.createElement(a.$,{size:d})),i)}},jnEw:(e,r,n)=>{n.d(r,{h8:()=>f,r5:()=>m,Pj:()=>p,qY:()=>v,ch:()=>g});var t=n("zThL"),a=n("Cmfx"),o=n("TSYQ"),s=n.n(o),d=n("pl5I"),i=n("XIYH"),l=n("OS6D"),u=n("vM46");const c={Step:"VheJw",Content:"s_qAq",Header:"VUPKe",isGrouped:"USpd3",Actions:"oQEAZ","Actions-displayInline":"WD4IV"};function f(e){var r=e.children;return a.default.createElement("div",{className:c.Step},r)}function p(e){var r=e.grouped,n=e.children,o=s()(c.Content,(0,t.Z)({},c.isGrouped,r));return a.default.createElement("div",{className:o},n)}function m(e){var r=e.children,n=(0,l.Lr)("Checkout::Actions::RenderBefore"),t=(0,i.lz)().actions.display,o=void 0===t?"inline":t,f=s()(c.Actions,c[(0,d.O)("Actions-display",o)]);return a.default.createElement(a.default.Fragment,null,a.default.createElement(u._,{extensions:n,spacing:"base"}),a.default.createElement("div",{className:f},r))}function v(e){var r=e.children;return a.default.createElement("div",{className:c.PrimaryAction},r)}function g(e){var r=e.children;return a.default.createElement("div",{className:c.SecondaryAction},r)}},hgQp:(e,r,n)=>{n.d(r,{c:()=>v,e:()=>m});var t=n("79Ja"),a=n("5hh5"),o=n("PIe1"),s=(n("ma9I"),n("2eJa"),n("1AHG"),n("rB9j"),n("hByQ"),n("y7qt")),d=n("Cmfx"),i=n("GVTs"),l=n("MhoZ"),u=n("Dc49"),c=n("l11y"),f=function(e){function r(){for(var r,n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return(r=e.call.apply(e,[this].concat(t))||this).name="MissingAutocompleteEndpointError",r}return(0,a.Z)(r,e),(0,t.Z)(r)}((0,o.Z)(Error)),p=(0,u.Q)("Autocomplete-IFrame");function m(){var e=(0,s.F)("autocomplete-sandbox"),r=(0,d.useRef)(),n=(0,c.M)(void 0,p);return(0,d.useLayoutEffect)((function(){if(!e)throw new l.br("Unable to find autocomplete sandbox URL");var t=(0,i.lJ)({id:n,url:e,privileges:["allow-scripts","allow-same-origin"]});return r.current=(0,i.r2)(t,e),function(){var e;t.remove(),null==(e=r.current)||e.terminate()}}),[e,n]),(0,d.useMemo)((function(){return{search:function(){var e;if(!r.current)throw new f("Called search without valid autocomplete endpoint");return(e=r.current.call).search.apply(e,arguments)},fetchAddress:function(){var e;if(!r.current)throw new f("Called fetchAddress without valid autocomplete endpoint");return(e=r.current.call).fetchAddress.apply(e,arguments)}}}),[])}function v(){var e=(0,s.F)("autocomplete-sandbox"),r=(0,d.useRef)();return(0,d.useLayoutEffect)((function(){var n;try{if(!e)throw new l.br("Unable to find autocomplete sandbox URL");(n=(0,i.lJ)({id:"validation",url:e,privileges:["allow-scripts","allow-same-origin"]})).addEventListener("load",(function(){r.current=(0,i.r2)(n,e)}))}catch(t){if(t instanceof l.br)return function(){}}return function(){var e;n.remove(),null==(e=r.current)||e.terminate()}}),[e]),(0,d.useMemo)((function(){return{validation:function(){var e;if(!r.current)throw new f("Called validation without valid autocomplete endpoint");return(e=r.current.call).validation.apply(e,arguments)}}}),[])}},l11y:(e,r,n)=>{n.d(r,{M:()=>a});var t=n("Cmfx");function a(e,r){var n,a=(0,t.useRef)(e);return a.current=null!=(n=null!=e?e:a.current)?n:r(),a.current}},aHS3:(e,r,n)=>{n.d(r,{$:()=>s}),n("4mDm"),n("Tskq"),n("07d7"),n("PKPk"),n("3bBZ");var t=n("0xfQ"),a=n("SsNy"),o=new Map([[a.z.InsufficientFunds,"insufficient_funds"],[a.z.InvalidPaymentMethod,"cannot_verify"],[a.z.FundingError,"processing_error"],[a.z.CanceledPaypalBillingAgreement,"processing_error"],[a.z.TokenExpired,"processing_error"],[a.z.InvalidToken,"processing_error"],[a.z.UnilateralAuthError,"processing_error"],[a.z.ThirdPartyInternalError,"processing_error"],[a.z.AuthorizationError,"processing_error"],[a.z.InvalidCurrency,"processing_error"],[a.z.InvalidItemTotal,"processing_error"],[a.z.InvalidCurrency,"processing_error"],[a.z.UnprocessableTransaction,"processing_error"],[a.z.InvoiceAlreadyPaid,"processing_error"],[a.z.AuthenticationError,"cannot_verify"],[a.z.IncorrectNumber,"cannot_verify"],[a.z.IncorrectCvc,"cannot_verify"],[a.z.IncorrectZip,"cannot_verify"],[a.z.IncorrectAddress,"cannot_verify"],[a.z.IncorrectPin,"cannot_verify"],[a.z.AuthenticationError,"three_d_secure_failed"],[a.z.InvalidNumber,"invalid_number"],[a.z.InvalidExpiryDate,"invalid_expiry_date"],[a.z.InvalidCvc,"invalid_cvc"],[a.z.ExpiredCard,"expired_card"],[a.z.CardDeclined,"card_declined"],[a.z.CallIssuer,"call_issuer"],[a.z.PickUpCard,"pick_up_card"],[a.z.TestModeLiveCard,"test_mode_live_card"],[a.z.TransientError,"transient_error"],[a.z.InsufficientFunds,"insufficient_funds"],[a.z.InvalidShippingAddress,"invalid_shipping_address"],[a.z.MissingShippingAddress,"missing_shipping_address"],[a.z.InvalidPaymentMethod,"cannot_verify"],[a.z.PublicPaymentError,"generic_error"],[a.z.SuccessfulOffsiteWithGiftCardError,"successful_offsite_with_gift_card_error"]]);function s(e){var r=(0,t.q)(),n="generic_error";return e&&(n=o.get(e.code)||"generic_error"),r("payment_errors",{scope:n},{pick_up_card:"Your card was declined. Try again or use a different payment method.",cannot_verify:"Your payment details couldn’t be verified. Check your card details and try again.",invalid_number:"Enter a valid card number",invalid_expiry_date:"Enter a valid card expiry date",invalid_cvc:"Enter a valid security code",expired_card:"Your card has expired. Use a different payment method.",card_declined:"Your card was declined. Try again or use a different payment method.",processing_error:"There was an issue processing your payment. Try again or use a different payment method.",call_issuer:"Your card was declined. Use a different payment method or contact your bank for more information.",test_mode_live_card:"This store can’t accept real orders or real payments.",transient_error:"There was a problem processing your payment. Try refreshing this page or check your internet connection.",insufficient_funds:"Your payment was declined due to insufficient funds. Try again or use a different payment method.",generic_error:"There was an issue processing your payment. Try again or use a different payment method.",three_d_secure_failed:"Your payment couldn’t be verified. Try again or use a different payment method.",missing_shipping_address:"Your payment couldn’t be processed because your shipping address is missing. Add a shipping address and try again.",invalid_shipping_address:"Your payment couldn’t be processed because we couldn’t find your shipping address. Check your shipping address and try again.",successful_offsite_with_gift_card_error:"There was an issue processing your gift card payment. Try again or use a different payment method.",development_store_order_limit_reached:"You’ve reached the limit for development store orders with this payment processor. To place another order, you’ll need to use a test payment gateway. Learn more about %{development_store_order_testing_docs_link}.",development_store_with_order_limit:"To place a test order, you’ll need to use a test payment gateway. Learn more about %{development_store_order_testing_docs_link}.",development_store_order_testing_docs_link:"testing orders in development stores"})}}}]);